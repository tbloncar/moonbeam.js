var moonbeam=function(){function e(e){var n=dom.createNodeTree(tmpl.get("container")),t=dom.createNodeTree(tmpl.get("button"));dom.transferAttrs(e,n),n.appendChild(t),n.appendChild(e.cloneNode(!0)),t.addEventListener("click",function(e){var n=dom.getActiveRange(),t=dom.createNodeTree(tmpl.get("highlight"));t.addEventListener("dblclick",function(e){var n=t.parentNode;console.log(t.childNodes),n.replaceChild(t.childNodes[0],t),n.normalize()}),t.addEventListener("click",function(e){}),n&&(console.log(n.toString()),n.surroundContents(t))}),e.parentNode.replaceChild(n,e)}return{bind:e}}();
var dom=function(){function t(){var t;return window.getSelection?t=window.getSelection():document.selection&&"Control"!==document.selection.type&&(t=document.selection),t}function e(t,e){t.classList?t.classList.add(e):t.className+=""+e}function n(t,e){t.classList?e===!0?t.classList=[]:t.classList.remove(e):t.className=e===!0?"":t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function i(t){var e=document.implementation.createHTMLDocument();return e.body.innerHTML=t,e.body.children[0]}function s(){var e,n=t();return n.rangeCount>0&&(e=n.getRangeAt(0)),e}function r(t,i){var s=(t.getAttribute("id"),t.getAttribute("class")),r=s?s.split(" "):[];i.setAttribute("id",t.getAttribute("id"));for(var c=0,o=r.length;o>c;++c)e(i,r[c]);t.setAttribute("id",""),n(t,!0)}return{addClass:e,removeClass:n,createNodeTree:i,transferAttrs:r,getActiveRange:s}}();
var tmpl=function(){function n(n){return TEMPLATECACHE[n]}return{get:n}}();
var TEMPLATECACHE={};TEMPLATECACHE.button='<a href="javascript:void(0)" class="mb-btn">comment</a>',TEMPLATECACHE.container='<div class="mb-container"></div>',TEMPLATECACHE.highlight='<span class="mb-hl"></span>';