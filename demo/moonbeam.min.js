var moonbeam=function(){function e(e){var n=t.getNodeTree('<div class="moonbeamed"></div>')[0],o=t.getNodeTree('<a href="javascript:void(0)" class="btn">comment</a>')[0];n.style.position="relative",o.style.position="absolute",o.style.top="0",o.style.right="5px",t.transferAttrs(e,n),n.appendChild(o),n.appendChild(e.cloneNode(!0)),o.addEventListener("click",function(e){var n=t.getActiveRange(),o=t.getNodeTree('<span class="mb-hl"></span>')[0];o.addEventListener("dblclick",function(e){var t=o.parentNode;console.log(o.childNodes),t.replaceChild(o.childNodes[0],o),t.normalize()}),o.addEventListener("click",function(e){}),n&&(console.log(n.toString()),n.surroundContents(o))}),e.parentNode.replaceChild(n,e)}var t=function(){function e(){var e;return window.getSelection?e=window.getSelection():document.selection&&"Control"!==document.selection.type&&(e=document.selection),e}function t(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}function n(e,t){e.classList?e.classList.add(t):e.className+=""+t}function o(e,t){e.classList?t===!0?e.classList=[]:e.classList.remove(t):e.className=t===!0?"":e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function i(e){var t=document.implementation.createHTMLDocument();return t.body.innerHTML=e,t.body.children}function s(){var t,n=e();return n.rangeCount>0&&(t=n.getRangeAt(0)),t}function c(e,t){var i=(e.getAttribute("id"),e.getAttribute("class")),s=i?i.split(" "):[];t.setAttribute("id",e.getAttribute("id"));for(var c=0,r=s.length;r>c;++c)n(t,s[c]);e.setAttribute("id",""),o(e,!0)}return{getSelectedText:t,addClass:n,removeClass:o,getNodeTree:i,transferAttrs:c,getActiveRange:s}}();return{bind:e}}();